"use strict";app.controller("modalAgentCommodityCtrl",["$scope","$modalInstance","_jiyin","params","FileUploader","dataToURL",function(t,i,o,e){t.infoList=e.infoList,t.title=e.title,t.ael=e.ael,t.getAgent=function(){t.title="添加代理商",o.modal({tempUrl:"/source/admin/tpl/modal/modal-agentAddCommodity.html",tempCtrl:"agentAddCommodityCtrl",ok:t.addAgent,size:"lg",params:{title:t.title,ael:"add"}})},t.addAgent=function(i){t.agentName=i.name,t.infoList.agent_id=i.id},t.add_commodity=function(){return t.agentName?(t.title="添加代理商商品",void o.modal({tempUrl:"/source/admin/tpl/modal/modal-agentAddCommodity.html",tempCtrl:"agentAddCommodityCtrl",ok:t.add,size:"lg",params:{title:t.title,infoList:t.discount,roleList:t.roleList,ael:"add"}})):void o.msg("e","请选择代理商")},t.commodity_ids=[],t.commodity_list=[],t.selecteCommodities=[],t.selecteCommodityList=[],t.deleteList=[],t.ids=[],t.add=function(i){angular.forEach(i,function(i){(0==t.commodity_ids.length||-1==t.commodity_ids.indexOf(i.id))&&(i.number=1,t.commodity_ids.push(i.id),t.commodity_list.push(i))}),0!=t.selecteCommodityList.length&&angular.forEach(t.selecteCommodityList,function(i){-1!=JSON.stringify(t.commodity_list).indexOf(i.id)&&angular.forEach(t.commodity_list,function(o,e){o.id==i.id&&(t.commodity_list.splice(e,1),t.commodity_ids.splice(i.id,1))})}),angular.forEach(t.commodity_list,function(i){t.selecteCommodityList.push(angular.copy(i))}),t.idStr=t.commodity_ids.join(",")},t.delete_commodity=function(i){if(confirm("确定删除该商品吗？")){for(var o=0;o<t.selecteCommodityList.length;o++)t.selecteCommodityList[o].id==i&&(t.selecteCommodityList.splice(o,1),t.commodity_ids.splice(i,1),o--);t.commodity_list=angular.copy(t.selecteCommodityList),t.idStr=t.commodity_ids.join(",")}},t.cancel=function(){i.dismiss("cancel")},t.confirm=function(){return t.infoList.agent_id?t.selecteCommodityList&&t.selecteCommodityList!=[]&&0!=t.selecteCommodityList.length?(t.submitData=[],t.submitSub={},angular.forEach(t.selecteCommodityList,function(i){t.submitSub.commodity_id=i.commodity_id,t.submitSub.commodity_specification_id=i.id,t.submitSub.price=i.price,t.submitSub.agent_id=t.infoList.agent_id,t.submitData.push(angular.copy(t.submitSub))}),void i.close(t.submitData)):void o.msg("e","请添加商品"):void o.msg("e","代理商名称为空")}}]);