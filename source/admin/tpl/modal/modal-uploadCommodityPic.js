"use strict";app.controller("uploadCommodityPicCtrl",["$scope","$modalInstance","_jiyin","params","FileUploader","dataToURL",function(t,e,i,a){t.infoList=[],t.gkpath="",t.title=a.title,t.infoList.id=a.id,t.ael=a.ael,t.gkpath=angular.copy(a.path),t.attachment_id="",t.path="",t.cancel=function(){e.dismiss("cancel")},t.$on("attachment_id",function(e,i){t.infoList.attachment_id=i,console.log(t.infoList)}),t.ok=function(){e.close(t.infoList)}}]),app.controller("FileUploadCtrl",["$scope","FileUploader","_jiyin","dataToURL",function(t,e,i,a){var n=t.uploader=new e({url:SITE_URL+"attachment/up_attachment"});n.filters.push({name:"customFilter",fn:function(){return this.queue.length<2}}),t.upload=function(e){i.fileMd5(e._file).then(function(o){i.dataPost("attachment/check_md5",a({md5_code:o.md5Code})).then(function(i){1==i.exist?(t.$emit("attachment_id",i.attachment_id),t.$emit("path",i.path),e.file.size=e._file.size,e.progress=100,e.isSuccess=!0,e.isUploaded=!0,e.uploader.progress+=100/n.queue.length):e.upload()})})},t.uploadAll=function(){angular.forEach(n.queue,function(e){i.fileMd5(e._file).then(function(o){i.dataPost("attachment/check_md5",a({md5_code:o.md5Code})).then(function(i){1==i.exist?(t.$emit("attachment_id",i.attachment_id),e.file.size=e._file.size,e.progress=100,e.isSuccess=!0,e.isUploaded=!0,n.progress+=100/n.queue.length):e.upload()})})})},n.onSuccessItem=function(e,i){t.$emit("attachment_id",i.attachment_id),t.$emit("path",i.path)},t.$on("clearQueue",function(){n.clearQueue()})}]);