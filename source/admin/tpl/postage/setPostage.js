app.controller("setPostageCtrl",["$scope","_jiyin","dataToURL","$stateParams","$state",function(t,a,e,o,i){if(t.postageList={},t.inputPage=1,t.useList=[],t.category=angular.copy(o.category),t.commodity=angular.copy(o.commodity),t.category_id=angular.copy(o.category_id),t.commodity_id=angular.copy(o.commodity_id),t.title="设置免邮",t.name="",0!=t.category_id)t.name="类别："+t.category;else{if(0==t.commodity)return void i.go("app");t.name="商品："+t.commodity}t.getData=function(){a.dataPost("admin/postage_admin/get_postage_by_category_or_commodity",e({category_id:t.category_id,commodity_id:t.commodity_id})).then(function(a){t.totalPage=0==a.total_page?1:a.total_page,t.useList=a.data})},t.getData(),t.getAllPostages=function(){a.dataGet("admin/postage_admin/get_all_postage").then(function(a){t.postageList=a.data})},t.getAllPostages(),t.view_detail=function(e){t.title="查看邮费规则",a.modal({tempUrl:"/source/admin/tpl/modal/modal-postageDetail.html",tempCtrl:"modalPostageDetailCtrl",size:"lg",params:{title:t.title,infoList:e,ael:"show"}})},t.view_detail_index=function(a){var e=t.postageList[a-2];e&&t.view_detail(e)},t.add=function(o){var i=t.postageList[o-2];i&&a.dataPost("admin/postage_admin/set_postage_for_category_or_commodity",e({id:i.id,category_id:t.category_id,commodity_id:t.commodity_id})).then(function(e){1==e.success?(a.msg("s","增加成功"),t.getData()):a.msg("e",e.msg)})},t.delete=function(o){a.dataPost("admin/postage_admin/remove_postage_for_category_or_commodity",e({id:o.cid})).then(function(e){1==e.success?(a.msg("s","删除成功"),t.getData()):a.msg("e",e.msg)})},t.nextPage=function(){t.inputPage<t.totalPage?(t.inputPage++,t.getData()):a.msg("e","当前是最后一页")},t.previousPage=function(){t.inputPage>1?(t.inputPage--,t.getData()):a.msg("e","当前是第一页")},t.firstPage=function(){t.inputPage=1},t.lastPage=function(){t.inputPage=t.totalPage,t.getData()},t.selectPage=function(a){t.inputPage=a,t.getData()}}]);